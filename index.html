<!DOCTYPE html>
<html lang="zh">
<head>
    <link href="css/kuangjia.css" rel="stylesheet" type="text/css"/>
    <script src="js/allJS.js" type="text/javascript"></script>
    <script src="js/kuangjia/jquery.js" type="text/javascript"></script>
    <script src="js/kuangjia/echars.js" type="text/javascript"></script>
    <script src="js/jssha256.js" type="text/javascript"></script>
    <!--    设备总览图表    -->
    <script src="js/host/hostall.js"></script>
    <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
    <title>Jaina</title>
</head>
<body>
<!-- 登录页 -->
<div class="background_color">
</div>
<div class="login_div" id="login_div">
    <div class="logo">
        <img alt="这是logo！" src="img/logo.png" style="width: 50%;left: 22.5%;top: 20%;"/>
    </div>
    <div class="login_form" id="login_form">
        <form action="#" method="post">
            <label for="username" style="font-size: 14px;color: #000;">用户名：</label>
            <!-- 横向内边距为2*3=6% 维持宽度100%，不至于超出范围 -->
            <input autofocus="autofocus" id="username" maxlength="20" name="username" onkeydown="keyLogin()" style="border: 1px solid #888;height: 10%;width: 94%;padding: 1% 2%;border-radius: 2px;margin-top: 5px;" type="text">
            <br /><br />
            <label for="passwd" style="font-size: 14px;color: #000;">密码：</label>
            <input id="passwd" name="passwd" onkeydown="keyLogin()" style="border: 1px solid #888;height: 10%;width: 94%;padding: 1% 2%;border-radius: 2px;margin-top: 5px;"  type="password">
            <br /><br /><br />
            <input class="submit" id="loginbtn" onclick="loginJudge()" style="top: 0%;" type="button" value="登  录">
        </form>
    </div>
    <p style="color: #CCC;position: relative;top: 25%;left: 17vh;font-size: 2.2vh;">自动化运维与监控系统@2021 by ***</p>
</div>
<!-- 导航栏  -->
<div class="head_div" id="head_div">
    <!--loading（）：点击监控面板按钮 重新触发刷新事件-->
    <div class="panel_btn" onclick="" style="width: 4vw;box-shadow: none;background-image: none;margin: 0;top: -4px;border-radius: 100px;" title="当前用户">
        <img alt="logo" src="img/logo.png" style="left: 20%;" width="70%">
    </div>
    <div class="panel_btn" onclick="btnOnClick(this);(function (){if (getCookie('flushPanel') == 1){ }else{ loading(); }setTimeout( function (){oneFlush();},470 )})()" title="内存、硬盘、网络、处理器图表">监控面板</div>
    <div class="host_btn" onclick="btnOnClick(this);(function (){setCookie('flushPanel',0,10);})()" title="设备的总览、列表、添加">设备管理</div>
    <div class="checking_btn" onclick="btnOnClick(this);(function (){setCookie('flushPanel',0,10);})()" title="设备的连通、性能、端口、硬件">自动巡检</div>
    <div class="user_btn" onclick="btnOnClick(this);(function (){setCookie('flushPanel',0,10);})()" title="系统用户、设备用户、添加">用户管理</div>
    <div class="setup_btn" onclick="btnOnClick(this);(function (){setCookie('flushPanel',0,10);})()" title="退出登录、修改密码、系统状态、查看日志">系统设置</div>
    <p id="clock" style="top: 18%;left: 30vw;color: #FFF;font-family: fantasy;display: inline;"></p>
    <!--     Jaina 待删除        <script src="js/system/date.js"></script>-->
</div>
<!-- 监控面板 -->
<div class="panel" id="panel">
    <div class="view" id="memory" style="top: 2%;left: 3%;">
        <script src="js/panel/memory.js"></script>
    </div>
    <div class="view" id="network" style="top: 4%;left: 3%;">
        <script src="js/panel/network.js"></script>
    </div>
    <div class="view" id="cpu" style="top: -41%;left: 52%;">
        <script src="js/panel/cpu.js"></script>
    </div>
    <div class="view" id="disk" style="top: -133%;left: 52%;">
        <script src="js/panel/disk.js"></script>
    </div>
</div>

<!-- 主机管理 -->
<div class="host" id="host">
    <!-- 左侧边栏 -->
    <div class="host_left">
        <!-- 设备总览 -- Linux/MySQL/Other -->
        <div class="host_left_all" onclick="btnOnClick(this)" title="所有设备及分类">设备总览</div>
        <!-- 设备列表 -- 修改/删除 -->
        <div class="host_left_list" onclick="btnOnClick(this)" title="所有设备及设备信息">设备列表</div>
        <!-- 添加设备 -- 表单 -->
        <div class="host_left_addhost" onclick="btnOnClick(this)" title="添加某种设备">添加设备</div>
    </div>
    <!-- 右侧面板 -->
    <div class="host_right">
        <div class="host_right_all" id="host_right_all">
            <div id="hostall" style="width: 90vh;height: 90vh;padding-left: 28%;padding-top: 3%;">
                <!--              Jaina 待删除           <script src="js/host/hostall.js"></script>-->
            </div>
        </div>
        <div class="host_right_list" id="host_right_list">
            <div class="alltable_head">
                <p>设备列表</p>
                <input id="searchHost" maxlength="20" onkeydown="keySearchHost()" placeholder="  名称/类型/地址" style="height: 4vh;width: 24vw;top: -6vh;left: 45vw;background-color: #ddd;border-radius: 3px;color: #000;box-shadow: 2px 2px 2px 2px #888;" type="text">
                <div class="ok" id="searchHostBtn" onclick="SearchHost()" style="height: 4vh;width: 4vw;line-height: 3.5vh;left: 70vw;">搜索</div>
            </div>
            <table class='alltable' id="SearchTr"> </table>
        </div>
        <div class="host_right_addhost" id="host_right_addhost">
            <div class="alltable_head">
                <p>添加设备</p>
            </div>
            <div class="addhost_form" style="height: 68vh;">
                <p><i><b>第一步 - 安装：</b></i></p> <br>
                <p style="background-color: #EEE;line-height: 25px;padding-top: 0.5vh;padding-bottom: 0.5vh;width: 70vw;top: -1vh;">
                    &nbsp;&nbsp;#&nbsp;wget http://<?php echo file_get_contents('http://127.0.0.1/php/ServerIP.php'); ?>/Client/ -P /opt/ <br>
                    &nbsp;&nbsp;#&nbsp;wget -nc -B http://<?php echo file_get_contents('http://127.0.0.1/php/ServerIP.php'); ?>/Client/ -F -nH --cut-dirs=3 -i /opt/index.html -P /etc/jaina/ <br>
                    &nbsp;&nbsp;#&nbsp;mv /etc/jaina/jaina.sh /usr/bin/jaina && chmod a+x /usr/bin/jaina <br>
                </p>
                <p><i><b>第二步 - 添加设备：</b></i></p> <br>
                <p style="background-color: #EEE;line-height: 25px;padding-top: 0.5vh;padding-bottom: 0.5vh;width: 70vw;top: -1vh;">
                    <!--                                 &nbsp;&nbsp;#&nbsp;jaina addhost  <?php echo file_get_contents('http://127.0.0.1/php/ServerIP.php'); ?> <br>-->
            </div>
        </div>
    </div>
</div>
<!-- 自动巡检 -->
<div class="checking" id="checking">
    <!-- 左侧边栏 -->
    <div class="checking_left">
        <!-- 连通性检测 -- Ping/可登录 -->
        <div class="checking_left_link" onclick="btnOnClick(this);" title="Ping命令检测">连通性检测</div>
        <!-- 性能检测 -- disk读写/网速/CPU/内存 -->
        <div class="checking_left_test" onclick="btnOnClick(this)" title="磁盘、网络、处理器性能">性能检测</div>
        <!-- 端口检测 -- 主机暴露端口 -->
        <div class="checking_left_port" onclick="btnOnClick(this)" title="设备端口开放情况">端口检测</div>
        <!-- 硬件检测 -- cpu/内存条/网卡/硬盘(数量、规格) -->
        <div class="checking_left_device" onclick="btnOnClick(this)" title="硬件信息">硬件检测</div>
    </div>
    <!-- 右侧面板 -->
    <div class="checking_right">
        <!-- 连通性检测 -->
        <div class="checking_right_link" id="checking_right_link">
            <div class="alltable_head">
                <p>设备列表</p>
            </div>
            <table class='alltable' id="alltable"> </table>
        </div>
        <!-- 性能测试 -->
        <div class="checking_right_test" id="checking_right_test">
            <div class="addhost_form" style="height: 18%;">
                <select id="perfSingle" style="top: 33%;left: 12%;height: 5vh;width: 13vw;border-radius: 4px;"> </script>
                </select>
                <div class="ok" id="hostDisk" onclick="hostPerf(this)" style="position: absolute;top: 38%;left: 34%;">&nbsp;硬盘</div>
                <div class="ok" id="hostNetwork" onclick="hostPerf(this)" style="position: absolute;top: 38%;left: 46%;">&nbsp;网络</div>
                <div class="ok" id="hostCpu" onclick="hostPerf(this)" style="position: absolute;top: 38%;left: 58%;">&nbsp;处理器</div>
            </div>
            <br />
            <br />
            <table class='alltable' id="checkingPerf">
                <div class="alltable_head">
                    <p>测试结果</p>
                </div>
            </table>
        </div>
        <!-- 端口检测 -->
        <div class="checking_right_port" id="checking_right_port">
            <div class="addhost_form">
                <select id="perfSinglePort" style="top: 14%;left: 12%;height: 5vh;width: 13vw;border-radius: 4px;">
                    <option value ="">请选择主机</option>
                </select>
                <!-- Jaina 这儿曾有重复的ID hostDisk -->
                <div class="ok" id="hostPort" onclick="hostPort()" style="position: absolute;top: 23%;left: 34%;height: 50%;">&nbsp;端口检测</div>
            </div>
            <br />
            <br />
            <table class='alltable' id="checkingPerfPort">
                <div class="alltable_head">
                    <p>测试结果</p>
                </div>
                <tr>
                    <th>主机名</th><th>地址</th><th>端口类型</th><th>端口</th><th>进程</th>
                </tr>
            </table>
        </div>
        <!-- 硬件检测 -->
        <div class="checking_right_device" id="checking_right_device" style="overflow-y: scroll;overflow-x: clip;width: 81vw;">
            <div class="addhost_form">
                <form action="#" method="get">
                    <select id="perfSingleDevice" style="top: 14%;left: 12%;height: 5vh;width: 13vw;border-radius: 4px;margin-top: 0.5%;">
                        <option value ="">请选择主机</option>
                    </select>
                    <div class="ok" id="hostDev" onclick="hostDevice()" style="position: absolute;top: 23%;left: 34%;height: 66%;">&nbsp;设备检测</div>
                </form>
            </div>
            <br />
            <br />
            <table class='alltable' id="checkingPerfDevice">
                <div class="alltable_head">
                    <p>CPU</p>
                </div>
                <tr>
                    <th>CPU核心</th><th>CPU型号</th><th>CPU频率</th>
                </tr>
            </table>
            <br />
            <table class='alltable' id="checkingPerfDeviceMother">
                <div class="alltable_head">
                    <p>主板</p>
                </div>
                <tr>
                    <th>主板型号</th>
                </tr>
            </table>
            <br />
            <table class='alltable' id="checkingPerfDeviceMemory">
                <div class="alltable_head">
                    <p>内存</p>
                </div>
                <tr>
                    <th>主板型号</th>
                </tr>
            </table>
            <br />
            <table class='alltable' id="checkingPerfDeviceNetwork">
                <div class="alltable_head">
                    <p>网卡</p>
                </div>
                <tr>
                    <th>网卡型号</th><th>网卡速度</th>
                </tr>
            </table>
            <br />
            <table class='alltable' id="checkingPerfDeviceDisk">
                <div class="alltable_head">
                    <p>硬盘</p>
                </div>
                <tr>
                    <th>主板型号</th>
                </tr>
            </table>
        </div>
    </div>
</div>

<!-- 用户管理 -->
<div class="user" id="user">
    <!-- 左侧边栏 -->
    <div class="user_left">
        <!-- 系统用户 -- web用户 -->
        <div class="user_left_webUser" onclick="btnOnClick(this)" title="可登录本界面">系统用户</div>
        <!-- 设备用户 -- 主机用户 -->
        <div class="user_left_deviceUser" onclick="btnOnClick(this)" title="可登录设备">设备用户</div>
    </div>
    <!-- 右侧面板 -->
    <div class="user_right">
        <div class="user_right_webUser" id="user_right_WebUser">
            <div class="alltable_head">
                <p>系统用户列表</p>
            </div>
            <table class='alltable' id="alltableSysUser"> </table>
            <div class="ok" onclick="addUserWindows()" style="position: absolute;top: 1.5%;height: 6%;left: 87%;box-shadow: 2px 2px 2px 2px #bbb;border: none;line-height: 200%;">添加用户</div>
            <div class="floatWindows" id="addSysUser">
                <form class="addWindows">
                    <h4 align="center" style="top: -5%;">添加系统用户</h4>
                    <br>
                    <br>
                    <label for="userAdd" style="position: absolute;top: 18%;left: 22%;">用户名：</label>
                    <!-- 横向内边距为2*3=6% 维持宽度100%，不至于超出范围 -->
                    <input id="userAdd" maxlength="20" name="userAdd" style="position: absolute;top: 18%;left: 39%;" type="text">
                    <br>
                    <br>
                    <label for="userAddPasswd" style="position: absolute;top: 28%;left: 22%;">密&nbsp;&nbsp;&nbsp;码：</label>
                    <!-- 横向内边距为2*3=6% 维持宽度100%，不至于超出范围 -->
                    <input id="userAddPasswd" maxlength="20" name="userAddPasswd" style="position: absolute;top: 28%;left: 39%;" type="password">
                    <br>
                    <br>
                    <label for="email" style="position: absolute;top: 38%;left: 22%;">邮&nbsp;&nbsp;&nbsp;箱：</label>
                    <input id="email" maxlength="20" name="email" style="position: absolute;top: 38%;left: 39%;" type="email">
                    <br>
                    <br>
                    <label for="sex" style="position: absolute;top: 48%;left: 22%;">性&nbsp;&nbsp;&nbsp;别：</label>
                    <select id="sex" style="position: absolute;top: 48%;left: 39%;margin-left: 3%;">
                        <option value ="">请选择性别</option>
                        <option value="man">男</option>
                        <option value="woman">女</option>
                    </select>
                    <label for="phone" style="position: absolute;top: 58%;left: 22%;">电&nbsp;&nbsp;&nbsp;话：</label>
                    <input id="phone" maxlength="20" name="phone" style="position: absolute;top: 58%;left: 39%;" type="text">
                    <br>
                    <br>
                    <div class="floatWindowsBtn ok" onclick="addUserSys();location.reload();" style="top: 78%;">&nbsp;添加</div>
                    <div class="floatWindowsBtn ok" onclick="(function (){
                                 document.getElementById('addSysUser').style.animation='0.5s ease forwards running login_loginOk';
                                 document.getElementById('addSysUser').style.display='none';
                             })()" style="left: 30%;top: 78%;">&nbsp;关闭</div>
                </form>
            </div>
        </div>
        <div class="user_right_deviceUser" id="user_right_DeviceUser">
            <table class='alltable'>
                <div class="alltable_head">
                    <p>设备用户列表</p>
                </div>
                <tr>
                    <th>ID</th><th>IP地址</th><th>用户名</th><th>密码</th>
                </tr>
                <!--                         <?php-->
                <!--//                         Jaina 待完成-->
                <!--//                         echo file_get_contents('http://localhost/php/user/devList.php');-->
                <!--                         ?>-->
            </table>
            <button class="ok" onclick="addUserWindowsDev()" style="position: absolute;top: 1.5%;height: 6%;left: 87%;box-shadow: 2px 2px 2px 2px #bbb;border: none;">添加用户</button>
            <div class="floatWindows" id="addSysUserDev">
                <form class="addWindows">
                    <h4 align="center" style="top: -5%;">添加设备用户</h4>
                    <label for="ipaddressDev" style="position: absolute;top: 18%;left: 22%;">IP地址：</label>
                    <!-- 横向内边距为2*3=6% 维持宽度100%，不至于超出范围 -->
                    <input id="ipaddressDev" maxlength="20" name="ipaddressDev" style="position: absolute;top: 18%;left: 39%;" type="text">
                    <br>
                    <br>
                    <label for="userDev" style="position: absolute;top: 30%;left: 22%;">用户名：</label>
                    <!-- 横向内边距为2*3=6% 维持宽度100%，不至于超出范围 -->
                    <input id="userDev" maxlength="20" name="userDev" style="position: absolute;top: 30%;left: 39%;" type="text">
                    <br>
                    <br>
                    <label for="passwdDev" style="position: absolute;top: 42%;left: 22%;">密&nbsp;&nbsp;&nbsp;码：</label>
                    <!-- 横向内边距为2*3=6% 维持宽度100%，不至于超出范围 -->
                    <input id="passwdDev" maxlength="20" name="passwdDev" style="position: absolute;top: 42%;left: 39%;" type="password">
                    <br>
                    <br>
                    <div class="floatWindowsBtn ok" onclick="addUserDev();location.reload();" style="top: 75%;">&nbsp;添加</div>
                    <div class="floatWindowsBtn ok" onclick="(function (){
                                 document.getElementById('addSysUserDev').style.animation='0.5s ease forwards running login_loginOk';
                                 document.getElementById('addSysUserDev').style.display='none'
                             }
                             )();" style="left: 30%;top: 75%;">&nbsp;关闭</div>
                </form>
            </div>
        </div>
    </div>
</div>

<!-- 系统设置 -->
<div class="setup" id="setup" style="background: inherit;">
    <!--  时间 -->
    <div class="setup_package" class="sysTitle" id="setup_info" onclick="sysSetup('setup_info','setup_package','isBigA','isBigB')" style="left: 6%;top: 10%;">
        <h2 class="sysTitleTitle" id="Titsetup_info">系  统  组   件</h2>
        <div class="sysBody" id="Bodysetup_info" onclick="cancelBubble()">

        </div>
    </div>

    <!--  脚本 -->
    <div  class="setup_clock" class="sysTitle" id="setup_script" onclick="sysSetup('setup_script','setup_clock','isBig1A','isBig1B')" style="left: 29%;top: -65%;">
        <h2 class="sysTitleTitle" id="Titsetup_script">系  统  脚  本</h2>
        <div class="sysBody" id="Bodysetup_script" onclick="cancelBubble()">

        </div>
    </div>

    <!--  邮件 -->
    <div class="setup_about" class="sysTitle" id="setup_email" onclick="sysSetup('setup_email','setup_about','isBig2A','isBig2B')" style="left: 52%;top: -140%;">
        <h2 class="sysTitleTitle" id="Titsetup_email">邮  件  告  警</h2>
        <div class="sysBody" id="Bodysetup_email" onclick="cancelBubble()">
            <select id="emailCPU" style="top: 33%;left: 12%;height: 5vh;width: 13vw;border-radius: 4px;">
                <option value="">CPU占用 (%)</option>
                <option value="10">10 %</option>
                <option value="30">30 %</option>
                <option value="50">50 %</option>
                <option value="70">70 %</option>
                <option value="90">90 %</option>
            </select>
            <select id="emailMEM" style="top: 33%;left: 12%;height: 5vh;width: 13vw;border-radius: 4px;">
                <option value="">MEM剩余 (MB)</option>
                <option value="512">512 MB</option>
                <option value="1024">1024 MB</option>
                <option value="2048">2048 MB</option>
                <option value="3072">3072 MB</option>
                <option value="4096">4096 MB</option>
            </select>
            <select id="emailDISK" style="top: 33%;left: 12%;height: 5vh;width: 13vw;border-radius: 4px;">
                <option value="">DISK剩余 (GB)</option>
                <option value="1">1 GB</option>
                <option value="5">5 GB</option>
                <option value="10">10 GB</option>
                <option value="20">20 GB</option>
                <option value="50">50 GB</option>
            </select>
            <select id="emailTIME" style="top: 33%;left: 12%;height: 5vh;width: 13vw;border-radius: 4px;">
                <option value="">轮询间隔 (s)</option>
                <option value="10">10 s</option>
                <option value="30">30 s</option>
                <option value="60">60 s</option>
                <option value="120">120 s</option>
                <option value="300">300 s</option>
            </select>
            <label for="emailSetup" style="top: 48%;left: -53%;height: 5vh;width: 13vw;border-radius: 4px;">收件人：</label>
            <input id="emailSetup" style="top: 39%;left: 31%;height: 5vh;width: 13vw;border-radius: 4px;background-color: #d8e0ed;" type="email" />
            <button onclick="eMailSend()" style="top: 39%;left: 31%;height: 5vh;width: 13vw;border-radius: 4px;background-color: #d8e0ed;">提交</button>
        </div>
    </div>

    <!--  退出登录 -->
    <div class="setup_exit" class="sysTitle"  id="setup_logout" onclick="sysSetup('setup_logout','setup_exit','isBig3A','isBig3B')" style="left: 75%;top: -215%;">
        <h2 class="sysTitleTitle" id="Titsetup_logout">退&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;出</h2>
        <div class="sysBody" id="Bodysetup_logout" onclick="cancelBubble()">

        </div>
    </div>
</div>
<!-- 放在页面底部可以读到上面元素的ID值 -->
<script>
    $.get(
        "php/memcached.php",{"user":getCookie("UserName"),"token":getCookie("Token")},
        function (data){
            var obj = JSON.parse(data);
            if (obj.status == 1){
                //重置时间
                setCookie("UserName",obj.username,10);
                setCookie("Token",obj.token,10);
                //显示内容面板
                document.getElementById('head_div').style.animation='0.5s ease 0s 1 normal forwards running index_head_loginOk';
                document.getElementById('head_div').style.display='block';
                document.getElementById('panel').style.display='block';
                document.getElementById('panel').style.animation='0.5s ease 0s 1 normal forwards running index_panel_loginOk';
                //显示离开时的面板和子面板
                lastView(getCookie('panelView'));
                lastViewClild(getCookie('Child'));
                //刷新监控面板(登陆成功后，就会立马刷新数据) -- 解决：避免刷新后图表缩成一团
                oneFlush();
                //刷新所有查询数据
                allFlush();
            }else{
                //播放拒绝动画
                document.getElementById('login_div').style.animation='0.5s ease 0s 1 normal forwards running login_loginView';
                document.getElementById('login_div').style.display='block';
            }
        }
    );
</script>

</body>
</html>